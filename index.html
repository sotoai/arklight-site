<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arklight Project — Arklight Cognitive Index (ACI)</title>
    <style>
        :root {
            --bg-primary: #000000;
            --bg-secondary: #0a0a0a;
            --bg-tertiary: #111111;
            --bg-card: #0d0d0d;
            --bg-hover: #141414;
            --bg-elevated: #1a1a1a;
            --border-primary: rgba(255, 255, 255, 0.08);
            --border-secondary: rgba(255, 255, 255, 0.12);
            --border-hover: rgba(255, 255, 255, 0.2);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --text-muted: rgba(255, 255, 255, 0.4);
            --text-dim: rgba(255, 255, 255, 0.25);
            --accent-primary: #ffffff;
            --accent-blue: #3b82f6;
            --accent-green: #22c55e;
            --accent-yellow: #eab308;
            --accent-red: #ef4444;
            --glow-white: rgba(255, 255, 255, 0.05);
            --font-sans: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', 'Inter', sans-serif;
            --font-mono: 'SF Mono', 'Fira Code', 'Consolas', monospace;
            --transition-fast: 200ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-medium: 400ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 600ms cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            font-family: var(--font-sans);
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        ::selection {
            background: rgba(255, 255, 255, 0.2);
        }

        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        /* Layout */
        .app-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-primary);
            padding: 0 48px;
            height: 72px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 28px;
            height: 28px;
        }

        .logo-icon svg {
            width: 100%;
            height: 100%;
        }

        .logo-text {
            font-size: 15px;
            font-weight: 500;
            letter-spacing: 0.02em;
            color: var(--text-primary);
            text-transform: uppercase;
        }

        .demo-badge {
            font-size: 10px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            padding: 4px 10px;
            background: transparent;
            color: var(--text-muted);
            border: 1px solid var(--border-primary);
            border-radius: 2px;
        }

        .nav-tabs {
            display: flex;
            gap: 8px;
        }

        .nav-tab {
            padding: 10px 20px;
            font-size: 13px;
            font-weight: 400;
            letter-spacing: 0.02em;
            color: var(--text-muted);
            background: transparent;
            border: none;
            cursor: pointer;
            transition: all var(--transition-fast);
            position: relative;
        }

        .nav-tab::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 20px;
            right: 20px;
            height: 1px;
            background: var(--text-primary);
            transform: scaleX(0);
            transition: transform var(--transition-fast);
        }

        .nav-tab:hover {
            color: var(--text-secondary);
        }

        .nav-tab.active {
            color: var(--text-primary);
        }

        .nav-tab.active::after {
            transform: scaleX(1);
        }

        .nav-tab:focus {
            outline: none;
        }

        .nav-tab:focus-visible {
            outline: 1px solid var(--text-muted);
            outline-offset: 4px;
        }

        /* Main content */
        .main-content {
            flex: 1;
            padding: 120px 48px 80px;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        /* View containers */
        .view {
            display: none;
            animation: fadeIn var(--transition-medium);
        }

        .view.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 80px 0 100px;
            position: relative;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 800px;
            height: 600px;
            background: radial-gradient(ellipse at center, rgba(255, 255, 255, 0.03) 0%, transparent 70%);
            pointer-events: none;
        }

        .hero-eyebrow {
            font-size: 12px;
            font-weight: 500;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: 24px;
        }

        .hero-title {
            font-size: clamp(48px, 8vw, 72px);
            font-weight: 600;
            letter-spacing: -0.03em;
            line-height: 1.1;
            margin-bottom: 24px;
            position: relative;
        }

        .hero-subtitle {
            font-size: 18px;
            font-weight: 400;
            color: var(--text-secondary);
            margin-bottom: 48px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.7;
        }

        /* Impact Strip */
        .impact-strip {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1px;
            background: var(--border-primary);
            margin: 80px 0;
            border: 1px solid var(--border-primary);
        }

        .impact-card {
            background: var(--bg-primary);
            padding: 48px 24px;
            text-align: center;
            transition: background var(--transition-fast);
        }

        .impact-card:hover {
            background: var(--bg-secondary);
        }

        .impact-value {
            font-size: 48px;
            font-weight: 300;
            letter-spacing: -0.02em;
            margin-bottom: 8px;
            font-variant-numeric: tabular-nums;
        }

        .impact-label {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            line-height: 1.5;
        }

        .demo-disclaimer {
            font-size: 11px;
            color: var(--text-dim);
            text-align: center;
            margin-top: 24px;
            letter-spacing: 0.05em;
        }

        /* Section Headers */
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-primary);
        }

        .section-title {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.15em;
        }

        /* Controls */
        .controls-bar {
            display: flex;
            align-items: center;
            gap: 32px;
            margin-bottom: 40px;
            padding: 20px 0;
            border-bottom: 1px solid var(--border-primary);
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .control-label {
            font-size: 11px;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        select, input[type="text"] {
            background: transparent;
            border: 1px solid var(--border-primary);
            color: var(--text-primary);
            padding: 10px 16px;
            font-size: 13px;
            font-family: var(--font-sans);
            cursor: pointer;
            transition: all var(--transition-fast);
            appearance: none;
            -webkit-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 8L2 4h8z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            padding-right: 36px;
            min-width: 180px;
        }

        select:hover, input[type="text"]:hover {
            border-color: var(--border-hover);
        }

        select:focus, input[type="text"]:focus {
            outline: none;
            border-color: var(--text-muted);
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
            color: var(--text-secondary);
            cursor: pointer;
        }

        .checkbox-label input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: var(--text-primary);
            cursor: pointer;
        }

        /* Candidate Table */
        .candidate-table {
            width: 100%;
            border-collapse: collapse;
        }

        .candidate-table th,
        .candidate-table td {
            padding: 20px 24px;
            text-align: left;
            border-bottom: 1px solid var(--border-primary);
        }

        .candidate-table th {
            font-size: 10px;
            font-weight: 500;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.12em;
            cursor: pointer;
            transition: color var(--transition-fast);
            user-select: none;
            background: transparent;
        }

        .candidate-table th:hover {
            color: var(--text-muted);
        }

        .candidate-table th.sorted {
            color: var(--text-primary);
        }

        .candidate-table th .sort-indicator {
            margin-left: 6px;
            opacity: 0.4;
            font-size: 8px;
        }

        .candidate-table th.sorted .sort-indicator {
            opacity: 1;
        }

        .candidate-table tbody tr {
            cursor: pointer;
            transition: background var(--transition-fast);
        }

        .candidate-table tbody tr:hover {
            background: var(--bg-secondary);
        }

        .candidate-name {
            font-weight: 500;
            font-size: 15px;
            margin-bottom: 4px;
        }

        .candidate-id {
            font-family: var(--font-mono);
            font-size: 11px;
            color: var(--text-dim);
            letter-spacing: 0.02em;
        }

        .candidate-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--text-muted);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
        }

        .candidate-status.complete .status-dot {
            background: var(--accent-green);
        }

        .candidate-status.in-progress .status-dot {
            background: var(--accent-yellow);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        .role-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .role-chip {
            font-size: 10px;
            padding: 4px 10px;
            background: transparent;
            border: 1px solid var(--border-primary);
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .role-chip.primary {
            border-color: var(--text-muted);
            color: var(--text-secondary);
        }

        .score-cell {
            font-family: var(--font-mono);
            font-size: 14px;
            font-weight: 400;
            letter-spacing: 0.02em;
        }

        .score-cell.elite { color: var(--text-primary); }
        .score-cell.strong { color: var(--text-secondary); }
        .score-cell.developing { color: var(--text-muted); }
        .score-cell.concern { color: var(--accent-red); }

        /* Score Badge */
        .score-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 48px;
            padding: 6px 12px;
            font-family: var(--font-mono);
            font-size: 14px;
            font-weight: 400;
            border: 1px solid var(--border-primary);
        }

        .score-badge.elite {
            border-color: var(--text-secondary);
            color: var(--text-primary);
        }

        .score-badge.strong {
            color: var(--text-secondary);
        }

        .score-badge.developing {
            color: var(--text-muted);
        }

        /* Candidate Detail View */
        .detail-back {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: var(--text-muted);
            background: none;
            border: none;
            cursor: pointer;
            margin-bottom: 48px;
            padding: 0;
            transition: color var(--transition-fast);
            letter-spacing: 0.02em;
        }

        .detail-back:hover {
            color: var(--text-primary);
        }

        .detail-header {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 80px;
            padding-bottom: 60px;
            margin-bottom: 60px;
            border-bottom: 1px solid var(--border-primary);
        }

        .detail-candidate-info {
            max-width: 600px;
        }

        .detail-candidate-name {
            font-size: 48px;
            font-weight: 500;
            letter-spacing: -0.02em;
            margin-bottom: 16px;
        }

        .detail-candidate-meta {
            display: flex;
            align-items: center;
            gap: 24px;
            color: var(--text-muted);
            font-size: 13px;
            margin-bottom: 20px;
        }

        .detail-candidate-meta .divider {
            width: 1px;
            height: 12px;
            background: var(--border-secondary);
        }

        .detail-candidate-background {
            color: var(--text-secondary);
            font-size: 15px;
            line-height: 1.7;
        }

        .detail-aci-score {
            text-align: right;
            padding-left: 80px;
            border-left: 1px solid var(--border-primary);
        }

        .detail-aci-label {
            font-size: 10px;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.15em;
            margin-bottom: 16px;
        }

        .detail-aci-value {
            font-size: 96px;
            font-weight: 300;
            line-height: 1;
            margin-bottom: 8px;
            letter-spacing: -0.02em;
            font-variant-numeric: tabular-nums;
        }

        .detail-aci-percentile {
            font-size: 14px;
            color: var(--text-muted);
            margin-bottom: 16px;
        }

        .detail-aci-band {
            display: inline-block;
            font-size: 10px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            padding: 6px 16px;
            border: 1px solid var(--border-secondary);
        }

        .onboarding-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .onboarding-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
        }

        .onboarding-dot.accelerated { background: var(--accent-green); }
        .onboarding-dot.standard { background: var(--text-muted); }
        .onboarding-dot.structured-support { background: var(--accent-yellow); }

        /* Composite Scores Grid */
        .composites-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1px;
            background: var(--border-primary);
            margin-bottom: 80px;
            border: 1px solid var(--border-primary);
        }

        .composite-card {
            background: var(--bg-primary);
            padding: 40px 24px;
            transition: background var(--transition-fast);
        }

        .composite-card:hover {
            background: var(--bg-secondary);
        }

        .composite-label {
            font-size: 10px;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 16px;
            line-height: 1.4;
        }

        .composite-value {
            font-size: 36px;
            font-weight: 300;
            margin-bottom: 4px;
            letter-spacing: -0.01em;
            font-variant-numeric: tabular-nums;
        }

        .composite-percentile {
            font-size: 12px;
            color: var(--text-muted);
        }

        .composite-band {
            display: inline-block;
            margin-top: 12px;
            font-size: 9px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            padding: 4px 10px;
            border: 1px solid var(--border-primary);
            color: var(--text-muted);
        }

        /* Charts */
        .charts-grid {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 60px;
            margin-bottom: 80px;
        }

        .chart-container {
            padding: 40px;
            border: 1px solid var(--border-primary);
        }

        .chart-container.full-width {
            grid-column: 1 / -1;
        }

        .chart-title {
            font-size: 10px;
            font-weight: 500;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.15em;
            margin-bottom: 32px;
        }

        .radar-chart {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Horizontal Bar Chart */
        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .bar-item {
            display: grid;
            grid-template-columns: 160px 1fr 60px;
            align-items: center;
            gap: 20px;
        }

        .bar-label {
            font-size: 12px;
            color: var(--text-muted);
            text-align: right;
        }

        .bar-track {
            height: 2px;
            background: var(--border-primary);
            position: relative;
        }

        .bar-fill {
            height: 100%;
            background: var(--text-primary);
            transition: width var(--transition-slow);
            position: relative;
        }

        .bar-fill::after {
            content: '';
            position: absolute;
            right: 0;
            top: -4px;
            width: 2px;
            height: 10px;
            background: var(--text-primary);
        }

        .bar-fill.elite { background: var(--text-primary); }
        .bar-fill.elite::after { background: var(--text-primary); }
        .bar-fill.strong { background: var(--text-secondary); }
        .bar-fill.strong::after { background: var(--text-secondary); }
        .bar-fill.developing { background: var(--text-muted); }
        .bar-fill.developing::after { background: var(--text-muted); }
        .bar-fill.concern { background: var(--accent-red); }
        .bar-fill.concern::after { background: var(--accent-red); }

        .bar-percentile {
            font-family: var(--font-mono);
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Construct Sections */
        .construct-section {
            margin-bottom: 2px;
        }

        .construct-section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 24px 32px;
            background: var(--bg-secondary);
            cursor: pointer;
            transition: background var(--transition-fast);
            border: 1px solid var(--border-primary);
            border-bottom: none;
        }

        .construct-section:first-child .construct-section-header {
            border-top: 1px solid var(--border-primary);
        }

        .construct-section-header:hover {
            background: var(--bg-tertiary);
        }

        .construct-section-title {
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .construct-section-count {
            font-size: 12px;
            color: var(--text-dim);
            font-weight: 400;
        }

        .construct-section-toggle {
            color: var(--text-dim);
            font-size: 10px;
            transition: transform var(--transition-fast);
        }

        .construct-section.expanded .construct-section-toggle {
            transform: rotate(180deg);
        }

        .construct-cards {
            display: none;
            border: 1px solid var(--border-primary);
            border-top: none;
        }

        .construct-section.expanded .construct-cards {
            display: block;
        }

        /* Construct Card */
        .construct-card {
            padding: 28px 32px;
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-primary);
            transition: background var(--transition-fast);
        }

        .construct-card:last-child {
            border-bottom: none;
        }

        .construct-card:hover {
            background: var(--bg-secondary);
        }

        .construct-card-header {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 40px;
            cursor: pointer;
        }

        .construct-info {
            min-width: 0;
        }

        .construct-name {
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .construct-abbr {
            font-family: var(--font-mono);
            font-size: 10px;
            color: var(--text-dim);
            letter-spacing: 0.05em;
        }

        .construct-predicts {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .construct-matters {
            font-size: 12px;
            color: var(--text-dim);
        }

        .construct-scores {
            display: flex;
            align-items: center;
            gap: 32px;
        }

        .construct-score-main {
            text-align: right;
        }

        .construct-score-value {
            font-family: var(--font-mono);
            font-size: 28px;
            font-weight: 300;
            letter-spacing: -0.01em;
        }

        .construct-score-label {
            font-size: 9px;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .construct-score-secondary {
            text-align: right;
            min-width: 80px;
        }

        .construct-percentile {
            font-family: var(--font-mono);
            font-size: 13px;
            color: var(--text-muted);
        }

        .construct-ci {
            font-size: 11px;
            color: var(--text-dim);
        }

        .construct-expand-btn {
            background: none;
            border: 1px solid var(--border-primary);
            color: var(--text-dim);
            cursor: pointer;
            padding: 8px 12px;
            font-size: 10px;
            transition: all var(--transition-fast);
        }

        .construct-expand-btn:hover {
            border-color: var(--text-muted);
            color: var(--text-muted);
        }

        /* Evidence Panel */
        .construct-evidence {
            display: none;
            margin-top: 28px;
            padding-top: 28px;
            border-top: 1px solid var(--border-primary);
            animation: slideDown var(--transition-medium);
        }

        .construct-card.evidence-open .construct-evidence {
            display: block;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .evidence-section {
            margin-bottom: 28px;
        }

        .evidence-section:last-child {
            margin-bottom: 0;
        }

        .evidence-label {
            font-size: 9px;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.15em;
            margin-bottom: 12px;
        }

        .evidence-scenario {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.7;
            padding: 20px 24px;
            background: var(--bg-secondary);
            border-left: 2px solid var(--border-secondary);
        }

        .evidence-transcript {
            background: var(--bg-secondary);
        }

        .transcript-turn {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-primary);
        }

        .transcript-turn:last-child {
            border-bottom: none;
        }

        .transcript-speaker {
            font-size: 9px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 8px;
        }

        .transcript-speaker.system {
            color: var(--text-muted);
        }

        .transcript-speaker.candidate {
            color: var(--text-primary);
        }

        .transcript-content {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .transcript-timestamp {
            font-size: 11px;
            color: var(--text-dim);
            font-family: var(--font-mono);
            margin-top: 8px;
        }

        .evidence-rationale {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.7;
            padding: 20px 24px;
            background: var(--bg-secondary);
        }

        .evidence-indicators {
            display: flex;
            gap: 24px;
        }

        .indicator-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 12px;
            color: var(--text-muted);
            padding: 12px 20px;
            background: var(--bg-secondary);
        }

        .indicator-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
        }

        .indicator-dot.high { background: var(--accent-red); }
        .indicator-dot.medium { background: var(--accent-yellow); }
        .indicator-dot.low { background: var(--accent-green); }

        .standardization-note {
            font-size: 12px;
            color: var(--text-muted);
            padding: 16px 20px;
            background: var(--bg-secondary);
            border-left: 2px solid var(--border-secondary);
            line-height: 1.6;
        }

        /* Role Cutlines */
        .cutlines-container {
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 1px;
            background: var(--border-primary);
            border: 1px solid var(--border-primary);
        }

        .cutlines-roles {
            background: var(--bg-primary);
        }

        .cutlines-role-item {
            padding: 24px 28px;
            border-bottom: 1px solid var(--border-primary);
            cursor: pointer;
            transition: background var(--transition-fast);
        }

        .cutlines-role-item:last-child {
            border-bottom: none;
        }

        .cutlines-role-item:hover {
            background: var(--bg-secondary);
        }

        .cutlines-role-item.selected {
            background: var(--bg-tertiary);
        }

        .cutlines-role-name {
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 6px;
        }

        .cutlines-role-count {
            font-size: 12px;
            color: var(--text-dim);
        }

        .cutlines-detail {
            background: var(--bg-primary);
            padding: 40px;
        }

        .cutlines-detail h3 {
            font-size: 24px;
            font-weight: 500;
            letter-spacing: -0.01em;
            margin-bottom: 32px;
        }

        .cutlines-requirements {
            margin-bottom: 40px;
        }

        .requirement-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 0;
            border-bottom: 1px solid var(--border-primary);
        }

        .requirement-item:last-child {
            border-bottom: none;
        }

        .requirement-construct {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .requirement-threshold {
            font-family: var(--font-mono);
            font-size: 13px;
            color: var(--text-muted);
        }

        .cutlines-candidates {
            border-top: 1px solid var(--border-primary);
            padding-top: 32px;
        }

        .cutline-candidate-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 0;
            border-bottom: 1px solid var(--border-primary);
            cursor: pointer;
            transition: background var(--transition-fast);
        }

        .cutline-candidate-row:hover {
            background: var(--bg-secondary);
            margin: 0 -20px;
            padding-left: 20px;
            padding-right: 20px;
        }

        .cutline-candidate-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .cutline-status-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .cutline-status-icon.pass {
            color: var(--accent-green);
        }

        .cutline-status-icon.fail {
            color: var(--text-dim);
        }

        .cutline-candidate-name {
            font-weight: 400;
            font-size: 14px;
        }

        .cutline-score {
            font-family: var(--font-mono);
            font-size: 13px;
            color: var(--text-muted);
        }

        /* Fit Explanation */
        .fit-explanation {
            margin-top: 40px;
            padding: 32px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-primary);
        }

        .fit-title {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 24px;
        }

        .fit-section {
            margin-bottom: 24px;
        }

        .fit-section:last-child {
            margin-bottom: 0;
        }

        .fit-section-label {
            font-size: 9px;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.15em;
            margin-bottom: 12px;
        }

        .fit-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .fit-item .icon {
            flex-shrink: 0;
            margin-top: 2px;
            font-size: 10px;
        }

        .fit-item.driver .icon { color: var(--accent-green); }
        .fit-item.risk .icon { color: var(--accent-yellow); }

        /* Heatmap */
        .heatmap-container {
            overflow-x: auto;
            margin-bottom: 60px;
        }

        .heatmap-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
        }

        .heatmap-table th,
        .heatmap-table td {
            padding: 12px 8px;
            text-align: center;
            border: 1px solid var(--border-primary);
        }

        .heatmap-table th {
            background: var(--bg-secondary);
            font-weight: 500;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 9px;
        }

        .heatmap-table th.rotate {
            writing-mode: vertical-lr;
            text-orientation: mixed;
            transform: rotate(180deg);
            height: 80px;
            padding: 8px 4px;
        }

        .heatmap-table td.candidate-col {
            text-align: left;
            font-weight: 500;
            font-size: 12px;
            background: var(--bg-secondary);
            white-space: nowrap;
            padding-left: 16px;
        }

        .heatmap-cell {
            font-family: var(--font-mono);
            font-weight: 400;
            font-size: 11px;
        }

        /* Footer */
        .footer {
            padding: 40px 48px;
            border-top: 1px solid var(--border-primary);
            text-align: center;
        }

        .footer-disclaimer {
            font-size: 11px;
            color: var(--text-dim);
            margin-bottom: 12px;
            padding: 12px 24px;
            display: inline-block;
            border: 1px solid var(--border-primary);
            letter-spacing: 0.02em;
        }

        .footer p {
            font-size: 11px;
            color: var(--text-dim);
            letter-spacing: 0.05em;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .cutlines-container {
                grid-template-columns: 1fr;
            }

            .charts-grid {
                grid-template-columns: 1fr;
            }

            .composites-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .impact-strip {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 900px) {
            .header {
                padding: 0 24px;
                height: 64px;
            }

            .main-content {
                padding: 100px 24px 60px;
            }

            .detail-header {
                grid-template-columns: 1fr;
                gap: 40px;
            }

            .detail-aci-score {
                text-align: left;
                padding-left: 0;
                border-left: none;
                padding-top: 40px;
                border-top: 1px solid var(--border-primary);
            }

            .composites-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .bar-item {
                grid-template-columns: 120px 1fr 50px;
            }

            .impact-strip {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 600px) {
            .header {
                flex-direction: column;
                height: auto;
                padding: 16px 20px;
                gap: 16px;
            }

            .main-content {
                padding: 140px 20px 40px;
            }

            .hero-title {
                font-size: 36px;
            }

            .composites-grid {
                grid-template-columns: 1fr;
            }

            .impact-strip {
                grid-template-columns: 1fr;
            }

            .nav-tabs {
                flex-wrap: wrap;
                justify-content: center;
            }

            .detail-candidate-name {
                font-size: 32px;
            }

            .detail-aci-value {
                font-size: 64px;
            }
        }

        /* Utility Classes */
        .text-elite { color: var(--text-primary); }
        .text-strong { color: var(--text-secondary); }
        .text-developing { color: var(--text-muted); }
        .text-concern { color: var(--accent-red); }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            border: 0;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="header">
            <div class="logo-section">
                <div class="logo">
                    <div class="logo-icon">
                        <svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14 1L26 7.5V20.5L14 27L2 20.5V7.5L14 1Z" stroke="white" stroke-width="1" fill="none"/>
                            <path d="M14 7L20 10.5V17.5L14 21L8 17.5V10.5L14 7Z" stroke="white" stroke-width="0.75" fill="none" opacity="0.5"/>
                            <circle cx="14" cy="14" r="2" fill="white"/>
                        </svg>
                    </div>
                    <span class="logo-text">Arklight Project</span>
                </div>
                <span class="demo-badge">Demo</span>
            </div>
            <nav class="nav-tabs" role="tablist" aria-label="Main navigation">
                <button class="nav-tab active" role="tab" aria-selected="true" data-view="overview" tabindex="0">Overview</button>
                <button class="nav-tab" role="tab" aria-selected="false" data-view="candidates" tabindex="-1">Candidates</button>
                <button class="nav-tab" role="tab" aria-selected="false" data-view="cutlines" tabindex="-1">Role Cutlines</button>
                <button class="nav-tab" role="tab" aria-selected="false" data-view="heatmap" tabindex="-1">Matrix</button>
            </nav>
        </header>

        <main class="main-content">
            <!-- Overview View -->
            <div id="view-overview" class="view active" role="tabpanel" aria-labelledby="tab-overview">
                <section class="hero">
                    <p class="hero-eyebrow">Next-Generation Assessment</p>
                    <h1 class="hero-title">Arklight Cognitive Index</h1>
                    <p class="hero-subtitle">
                        Combining ASVAB-caliber cognitive measurement with adaptive conversational AI
                        to predict learning velocity, error avoidance, and mission reliability.
                    </p>
                </section>

                <div class="impact-strip" aria-label="Impact metrics">
                    <div class="impact-card">
                        <div class="impact-value">47%</div>
                        <div class="impact-label">Lower 90-Day<br>Attrition</div>
                    </div>
                    <div class="impact-card">
                        <div class="impact-value">2.3×</div>
                        <div class="impact-label">Faster Time<br>to Mastery</div>
                    </div>
                    <div class="impact-card">
                        <div class="impact-value">63%</div>
                        <div class="impact-label">Reduced False<br>Positives</div>
                    </div>
                    <div class="impact-card">
                        <div class="impact-value">4.1×</div>
                        <div class="impact-label">Integrity Flag<br>Detection</div>
                    </div>
                    <div class="impact-card">
                        <div class="impact-value">89%</div>
                        <div class="impact-label">Hiring Manager<br>Confidence</div>
                    </div>
                </div>
                <p class="demo-disclaimer">Illustrative demo metrics</p>

                <section class="section-header">
                    <h2 class="section-title">Candidate Dashboard</h2>
                </section>

                <div id="overview-dashboard"></div>
            </div>

            <!-- Candidates View -->
            <div id="view-candidates" class="view" role="tabpanel" aria-labelledby="tab-candidates">
                <section class="section-header">
                    <h2 class="section-title">Assessment Results</h2>
                </section>

                <div class="controls-bar">
                    <div class="control-group">
                        <label class="control-label" for="sort-select">Sort</label>
                        <select id="sort-select">
                            <option value="aci">ACI Score</option>
                            <option value="reliability">Reliability Index</option>
                            <option value="learning">Learning Velocity</option>
                            <option value="cyber">Cyber Aptitude</option>
                            <option value="manufacturing">Manufacturing Technical</option>
                            <option value="semiconductor">Semiconductor Ops</option>
                            <option value="integrity">Integrity Index</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="role-filter">Role</label>
                        <select id="role-filter">
                            <option value="all">All Roles</option>
                            <option value="fab">Semiconductor Fab Operator</option>
                            <option value="automation">Automation & Robotics</option>
                            <option value="quality">Quality Systems</option>
                            <option value="manufacturing">Manufacturing Systems</option>
                            <option value="reliability">Reliability / Failure Analysis</option>
                            <option value="ot-cyber">OT / Industrial Cyber</option>
                            <option value="controls">Controls / PLC Debug</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="cutline-filter">
                            <span>Meets cutline only</span>
                        </label>
                    </div>
                </div>

                <div id="candidates-table-container"></div>
            </div>

            <!-- Candidate Detail View -->
            <div id="view-candidate-detail" class="view" role="tabpanel">
                <button class="detail-back" id="back-to-candidates">
                    <span>←</span> Back to Candidates
                </button>
                <div id="candidate-detail-content"></div>
            </div>

            <!-- Role Cutlines View -->
            <div id="view-cutlines" class="view" role="tabpanel" aria-labelledby="tab-cutlines">
                <section class="section-header">
                    <h2 class="section-title">Role Cutlines & Fit Analysis</h2>
                </section>
                <div id="cutlines-content"></div>
            </div>

            <!-- Heatmap View -->
            <div id="view-heatmap" class="view" role="tabpanel" aria-labelledby="tab-heatmap">
                <section class="section-header">
                    <h2 class="section-title">Comparison Matrix</h2>
                </section>
                <div id="heatmap-content"></div>
            </div>
        </main>

        <footer class="footer">
            <div class="footer-disclaimer">
                All candidate data is synthetic for demonstration
            </div>
            <p>Arklight Project — ACI v2.4</p>
        </footer>
    </div>

    <script>
    (function() {
        'use strict';

        // ============================================================
        // DATA MODEL
        // ============================================================

        const CONSTRUCTS = {
            cognitive: [
                { id: 'FI', name: 'Fluid Intelligence', predicts: 'Novel problem-solving and rapid adaptation', matters: 'Critical for troubleshooting unfamiliar equipment failures' },
                { id: 'ER', name: 'Extrapolational Reasoning', predicts: 'Ability to project patterns and anticipate outcomes', matters: 'Predicts fault anticipation before cascade failures' },
                { id: 'ICI', name: 'Cognitive Interference Control', predicts: 'Focus maintenance under distraction', matters: 'Essential in high-alert environments with multiple alarm states' },
                { id: 'MAC', name: 'Metacognitive Accuracy', predicts: 'Self-awareness of knowledge boundaries', matters: 'Reduces overconfident errors in safety-critical decisions' },
                { id: 'TCDQ', name: 'Time-Compressed Decision Quality', predicts: 'Sound judgment under time pressure', matters: 'Determines response quality during line emergencies' },
                { id: 'CMR', name: 'Causal Misattribution Resistance', predicts: 'Avoiding false cause-effect conclusions', matters: 'Prevents chasing wrong root causes in diagnostics' },
                { id: 'ERCS', name: 'Error Recovery & Correction Speed', predicts: 'Rapid recognition and correction of mistakes', matters: 'Limits propagation of operator errors' }
            ],
            technical: [
                { id: 'SRD', name: 'Systems Reasoning & Diagnostics', predicts: 'Understanding complex system interactions', matters: 'Core skill for isolating faults in integrated manufacturing lines' },
                { id: 'PRAD', name: 'Pattern Recognition & Anomaly Detection', predicts: 'Detecting deviations from normal operation', matters: 'Early warning capability for quality and safety events' },
                { id: 'TMAQ', name: 'Technical Math & Quant Reasoning', predicts: 'Applied mathematical problem-solving', matters: 'Required for SPC, yield calculations, tolerance analysis' },
                { id: 'DLCT', name: 'Digital Logic & Computational Thinking', predicts: 'Understanding of logical operations and sequences', matters: 'Foundation for PLC programming and automation debugging' },
                { id: 'SPV', name: 'Spatial & Process Visualization', predicts: 'Mental modeling of physical systems and flows', matters: 'Enables effective work with CAD, process diagrams, equipment layouts' },
                { id: 'ASWL', name: 'Attention Stability Under Load', predicts: 'Sustained vigilance during extended operations', matters: 'Critical for long-shift monitoring of process parameters' },
                { id: 'FIDS', name: 'Fault Isolation & Debug Speed', predicts: 'Efficient narrowing of problem sources', matters: 'Minimizes mean-time-to-repair in production environments' },
                { id: 'ISI', name: 'Information Security Instinct', predicts: 'Natural caution with access and data handling', matters: 'First line of defense against social engineering and insider threats' },
                { id: 'RRCP', name: 'Reliability & Rules Compliance', predicts: 'Consistent adherence to procedures', matters: 'Maintains safety margins and audit readiness' }
            ],
            integrity: [
                { id: 'VCS', name: 'Values Conflict Scenarios', predicts: 'Ethical reasoning under competing pressures', matters: 'Predicts behavior when shortcuts tempt vs. protocol demands' },
                { id: 'BCC', name: 'Behavioral Consistency Cross-Check', predicts: 'Story alignment and response stability', matters: 'Flags potential deception or impression management' },
                { id: 'MAI', name: 'Mission Alignment Indicator', predicts: 'Fit with organizational values and mission', matters: 'Predicts engagement and discretionary effort over time' }
            ]
        };

        const ROLES = [
            { id: 'fab', name: 'Semiconductor Fab Operator', abbr: 'Fab Op' },
            { id: 'automation', name: 'Automation & Robotics Technician', abbr: 'Auto/Robot' },
            { id: 'quality', name: 'Quality Systems Specialist', abbr: 'Quality' },
            { id: 'manufacturing', name: 'Manufacturing Systems Operator', abbr: 'Mfg Sys' },
            { id: 'reliability', name: 'Reliability / Failure Analysis Technician', abbr: 'Rel/FA' },
            { id: 'ot-cyber', name: 'OT / Industrial Cyber Analyst', abbr: 'OT Cyber' },
            { id: 'controls', name: 'Controls / PLC Debug Technician', abbr: 'PLC/Ctrl' }
        ];

        const ROLE_CUTLINES = {
            'fab': {
                requirements: [
                    { construct: 'PRAD', threshold: 60 },
                    { construct: 'ASWL', threshold: 65 },
                    { construct: 'RRCP', threshold: 70 },
                    { composite: 'integrity', threshold: 65 }
                ]
            },
            'automation': {
                requirements: [
                    { construct: 'SRD', threshold: 65 },
                    { construct: 'DLCT', threshold: 60 },
                    { construct: 'FIDS', threshold: 60 },
                    { composite: 'manufacturingTechnical', threshold: 55 }
                ]
            },
            'quality': {
                requirements: [
                    { construct: 'PRAD', threshold: 70 },
                    { construct: 'TMAQ', threshold: 60 },
                    { construct: 'MAC', threshold: 60 },
                    { composite: 'integrity', threshold: 70 }
                ]
            },
            'manufacturing': {
                requirements: [
                    { construct: 'SPV', threshold: 55 },
                    { construct: 'ASWL', threshold: 60 },
                    { construct: 'RRCP', threshold: 65 },
                    { composite: 'manufacturingTechnical', threshold: 50 }
                ]
            },
            'reliability': {
                requirements: [
                    { construct: 'SRD', threshold: 70 },
                    { construct: 'CMR', threshold: 65 },
                    { construct: 'FIDS', threshold: 70 },
                    { composite: 'generalTechnical', threshold: 65 }
                ]
            },
            'ot-cyber': {
                requirements: [
                    { construct: 'PRAD', threshold: 65 },
                    { construct: 'ISI', threshold: 60 },
                    { construct: 'ICI', threshold: 60 },
                    { composite: 'integrity', threshold: 70 }
                ]
            },
            'controls': {
                requirements: [
                    { construct: 'DLCT', threshold: 65 },
                    { construct: 'FIDS', threshold: 65 },
                    { construct: 'SRD', threshold: 60 },
                    { composite: 'cyber', threshold: 55 }
                ]
            }
        };

        function generateCandidateData() {
            const candidates = [
                {
                    id: 'ACI-2024-0847',
                    name: 'Marcus Chen',
                    status: 'complete',
                    background: 'Former line cook, self-taught electronics hobbyist, community college coursework',
                    onboarding: 'Accelerated',
                    archetype: 'diamond',
                    baseScores: { cognitive: 82, technical: 78, integrity: 85 }
                },
                {
                    id: 'ACI-2024-0851',
                    name: 'Sarah Okonkwo',
                    status: 'complete',
                    background: 'Military avionics technician, 6 years active duty',
                    onboarding: 'Standard',
                    archetype: 'steady',
                    baseScores: { cognitive: 68, technical: 75, integrity: 92 }
                },
                {
                    id: 'ACI-2024-0856',
                    name: 'James Reilly',
                    status: 'complete',
                    background: 'BS Mechanical Engineering, 2 years automotive QC',
                    onboarding: 'Standard',
                    archetype: 'balanced',
                    baseScores: { cognitive: 71, technical: 73, integrity: 76 }
                },
                {
                    id: 'ACI-2024-0862',
                    name: 'Priya Sharma',
                    status: 'complete',
                    background: 'Community college mechatronics, internship at Tesla',
                    onboarding: 'Accelerated',
                    archetype: 'technical',
                    baseScores: { cognitive: 74, technical: 81, integrity: 79 }
                },
                {
                    id: 'ACI-2024-0869',
                    name: 'David Kim',
                    status: 'complete',
                    background: 'IT support background, cybersecurity bootcamp graduate',
                    onboarding: 'Standard',
                    archetype: 'cyber',
                    baseScores: { cognitive: 77, technical: 69, integrity: 82 }
                },
                {
                    id: 'ACI-2024-0873',
                    name: 'Tyler Morrison',
                    status: 'complete',
                    background: 'High school diploma, 3 years warehouse automation operator',
                    onboarding: 'Structured Support',
                    archetype: 'risky',
                    baseScores: { cognitive: 79, technical: 76, integrity: 52 }
                },
                {
                    id: 'ACI-2024-0881',
                    name: 'Elena Rodriguez',
                    status: 'complete',
                    background: 'AS Electronics Technology, semiconductor cleanroom experience',
                    onboarding: 'Standard',
                    archetype: 'fab-specialist',
                    baseScores: { cognitive: 65, technical: 79, integrity: 88 }
                },
                {
                    id: 'ACI-2024-0889',
                    name: 'Michael Oduya',
                    status: 'in-progress',
                    background: 'Physics undergraduate, research lab assistant',
                    onboarding: 'Accelerated',
                    archetype: 'analytical',
                    baseScores: { cognitive: 86, technical: 72, integrity: 80 }
                },
                {
                    id: 'ACI-2024-0894',
                    name: 'Jennifer Walsh',
                    status: 'complete',
                    background: 'Navy nuclear technician, honorable discharge',
                    onboarding: 'Accelerated',
                    archetype: 'elite',
                    baseScores: { cognitive: 88, technical: 85, integrity: 91 }
                },
                {
                    id: 'ACI-2024-0901',
                    name: 'Robert Tanaka',
                    status: 'complete',
                    background: 'Trade school HVAC, facility maintenance supervisor',
                    onboarding: 'Standard',
                    archetype: 'steady',
                    baseScores: { cognitive: 62, technical: 70, integrity: 86 }
                }
            ];

            return candidates.map(c => generateFullScores(c));
        }

        function generateFullScores(candidate) {
            const { baseScores, archetype } = candidate;
            const scores = {};
            const noise = () => Math.floor(Math.random() * 16) - 8;

            CONSTRUCTS.cognitive.forEach(construct => {
                let base = baseScores.cognitive + noise();
                if (archetype === 'diamond' && ['FI', 'ER', 'TCDQ'].includes(construct.id)) base += 8;
                if (archetype === 'steady' && ['ICI', 'MAC'].includes(construct.id)) base += 5;
                if (archetype === 'risky' && construct.id === 'ICI') base -= 15;
                if (archetype === 'analytical' && ['FI', 'ER', 'CMR'].includes(construct.id)) base += 10;
                if (archetype === 'elite') base += 5;
                scores[construct.id] = clampScore(base);
            });

            CONSTRUCTS.technical.forEach(construct => {
                let base = baseScores.technical + noise();
                if (archetype === 'diamond' && ['SRD', 'DLCT', 'FIDS'].includes(construct.id)) base += 6;
                if (archetype === 'steady' && ['RRCP', 'ASWL'].includes(construct.id)) base += 10;
                if (archetype === 'technical' && ['SRD', 'PRAD', 'FIDS'].includes(construct.id)) base += 8;
                if (archetype === 'cyber' && ['ISI', 'DLCT'].includes(construct.id)) base += 12;
                if (archetype === 'fab-specialist' && ['PRAD', 'ASWL', 'SPV'].includes(construct.id)) base += 10;
                if (archetype === 'elite') base += 5;
                scores[construct.id] = clampScore(base);
            });

            CONSTRUCTS.integrity.forEach(construct => {
                let base = baseScores.integrity + noise();
                if (archetype === 'risky') base -= 20;
                if (archetype === 'steady') base += 5;
                if (archetype === 'elite') base += 3;
                scores[construct.id] = clampScore(base);
            });

            const cognitiveAvg = average(CONSTRUCTS.cognitive.map(c => scores[c.id]));
            const technicalAvg = average(CONSTRUCTS.technical.map(c => scores[c.id]));
            const integrityAvg = average(CONSTRUCTS.integrity.map(c => scores[c.id]));

            const composites = {
                aci: Math.round(cognitiveAvg * 0.35 + technicalAvg * 0.45 + integrityAvg * 0.20),
                generalTechnical: Math.round(average([scores.FI, scores.SRD, scores.PRAD, scores.TMAQ, scores.DLCT])),
                manufacturingTechnical: Math.round(average([scores.SRD, scores.SPV, scores.ASWL, scores.FIDS, scores.RRCP])),
                semiconductor: Math.round(average([scores.PRAD, scores.ASWL, scores.SPV, scores.RRCP, scores.MAC])),
                cyber: Math.round(average([scores.ISI, scores.DLCT, scores.ICI, scores.PRAD, scores.SRD])),
                integrity: Math.round(integrityAvg),
                learningVelocity: Math.round(average([scores.FI, scores.ER, scores.MAC, scores.ERCS])),
                reliability: Math.round(average([scores.RRCP, scores.ASWL, scores.MAC, scores.VCS, scores.BCC]))
            };

            const roleScores = ROLES.map(role => {
                const cutline = ROLE_CUTLINES[role.id];
                let fitScore = 0;
                let passes = 0;
                cutline.requirements.forEach(req => {
                    const score = req.construct ? scores[req.construct] : composites[req.composite];
                    const percentile = scoreToPercentile(score);
                    if (percentile >= req.threshold) passes++;
                    fitScore += percentile - req.threshold;
                });
                return { role, fitScore, passes, total: cutline.requirements.length };
            });

            roleScores.sort((a, b) => b.fitScore - a.fitScore);
            const recommendedRoles = roleScores.slice(0, 2).filter(r => r.passes >= r.total - 1).map(r => r.role.id);

            return {
                ...candidate,
                scores,
                composites,
                recommendedRoles: recommendedRoles.length > 0 ? recommendedRoles : [roleScores[0].role.id]
            };
        }

        function clampScore(score) {
            return Math.max(20, Math.min(99, Math.round(score)));
        }

        function average(arr) {
            return arr.reduce((a, b) => a + b, 0) / arr.length;
        }

        function scoreToPercentile(score) {
            return Math.max(1, Math.min(99, score));
        }

        function getBand(percentile) {
            if (percentile >= 85) return { label: 'Elite', class: 'elite' };
            if (percentile >= 60) return { label: 'Strong', class: 'strong' };
            if (percentile >= 40) return { label: 'Developing', class: 'developing' };
            return { label: 'Concern', class: 'concern' };
        }

        function getConfidenceInterval(score) {
            const margin = Math.floor(Math.random() * 4) + 3;
            return `±${margin}`;
        }

        function ordinal(n) {
            const s = ['th', 'st', 'nd', 'rd'];
            const v = n % 100;
            return n + (s[(v - 20) % 10] || s[v] || s[0]);
        }

        const EVIDENCE_DATA = {
            'FI': {
                scenario: 'Candidate was presented with an unfamiliar robotic arm exhibiting erratic movement patterns. No manual was provided. Task: diagnose and propose a solution within 8 minutes.',
                transcript: [
                    { speaker: 'system', content: 'The robotic arm is moving erratically during pick-and-place operations. You have no documentation. What do you do first?', time: '00:00' },
                    { speaker: 'candidate', content: 'I\'d start by observing the pattern—is it random or does it repeat? I want to see if it correlates with specific positions or load conditions.', time: '00:42' },
                    { speaker: 'system', content: 'It seems to happen more frequently when reaching the far corner of the workspace. What\'s your hypothesis?', time: '01:15' },
                    { speaker: 'candidate', content: 'Could be a calibration drift at extension limits, or a worn joint. I\'d check if reducing the reach envelope stabilizes it before opening up the arm.', time: '02:03' }
                ],
                rationale: 'Candidate demonstrated structured hypothesis generation without relying on documentation. Showed ability to isolate variables systematically and proposed non-destructive diagnostic steps.',
                indicators: { timePressure: 'high', interruptions: 'medium', ambiguity: 'high' }
            },
            'PRAD': {
                scenario: 'Live process monitoring dashboard showing 12 parameters over 4 hours. One subtle deviation introduced at t+2.5h. Candidate must identify the anomaly.',
                transcript: [
                    { speaker: 'system', content: 'You\'re monitoring a wafer processing tool. Review the trends and report any concerns.', time: '00:00' },
                    { speaker: 'candidate', content: 'Chamber pressure looks stable, temperature within spec... wait, the RF power variance increased slightly around 2:30. It\'s within limits but the pattern changed.', time: '03:24' },
                    { speaker: 'system', content: 'Is that significant enough to act on?', time: '03:45' },
                    { speaker: 'candidate', content: 'The magnitude is small but the character changed—used to be random noise, now it\'s periodic. I\'d flag it for the next PM window even if we don\'t stop now.', time: '04:12' }
                ],
                rationale: 'Candidate detected subtle pattern shift despite nominal values. Distinguished between random variation and systematic change. Calibrated response appropriately.',
                indicators: { timePressure: 'low', interruptions: 'low', ambiguity: 'medium' }
            },
            'ICI': {
                scenario: 'Multi-tasking scenario with primary calibration task and frequent interruptions (simulated radio calls, alarms, colleague questions).',
                transcript: [
                    { speaker: 'system', content: 'Continue calibrating the measurement probe. [INTERRUPT: Alarm sounds] There\'s a low-priority alert on Line 3.', time: '00:00' },
                    { speaker: 'candidate', content: 'Acknowledged. I\'ll note it but I\'m mid-calibration. If it escalates, pull me out, but let me finish this step or we\'ll have to restart.', time: '00:18' },
                    { speaker: 'system', content: '[INTERRUPT: Colleague asks about break schedule] Also, when are we taking lunch?', time: '01:45' },
                    { speaker: 'candidate', content: 'After I finish this. Please hold non-urgent questions.', time: '01:52' }
                ],
                rationale: 'Maintained task focus despite multiple interruption types. Appropriately triaged interruptions by urgency. Did not sacrifice primary task quality for social responsiveness.',
                indicators: { timePressure: 'medium', interruptions: 'high', ambiguity: 'low' }
            },
            'ISI': {
                scenario: 'Social engineering attempt via simulated phone call requesting system access credentials for "urgent maintenance."',
                transcript: [
                    { speaker: 'system', content: '[Phone rings] Hi, this is Mike from IT. We need your login to push an urgent security patch to your workstation. Can you give me your password?', time: '00:00' },
                    { speaker: 'candidate', content: 'I can\'t give out my password over the phone. Is there a ticket number for this? I can verify with our IT lead.', time: '00:22' },
                    { speaker: 'system', content: 'There\'s no time for that. The patch has to go in now or we\'ll have to take the whole network down.', time: '00:35' },
                    { speaker: 'candidate', content: 'Then you\'ll need to take it down. I\'m not authorized to share credentials regardless of urgency. I can call the IT desk to verify you.', time: '00:48' }
                ],
                rationale: 'Candidate resisted social pressure and urgency framing. Offered verification path rather than outright refusal, showing security awareness without being obstructive.',
                indicators: { timePressure: 'high', interruptions: 'low', ambiguity: 'medium' }
            },
            'VCS': {
                scenario: 'Ethical dilemma: supervisor suggests skipping a time-consuming QC step to meet shift quota. No immediate safety risk but procedure violation.',
                transcript: [
                    { speaker: 'system', content: 'Your supervisor says: "We\'re behind quota. Skip the secondary inspection on these units—they look fine. I\'ll sign off."', time: '00:00' },
                    { speaker: 'candidate', content: 'I understand the pressure, but if we skip inspection and something slips through, it\'s worse for everyone. Can we flag these for next shift to catch up properly?', time: '00:34' },
                    { speaker: 'system', content: 'That makes me look bad to my boss. Just this once—nobody will know.', time: '00:52' },
                    { speaker: 'candidate', content: 'I\'m not comfortable with that. If the process is too slow we should raise it as a capacity issue, not work around it.', time: '01:15' }
                ],
                rationale: 'Candidate maintained procedural integrity under social pressure from authority figure. Offered constructive alternatives rather than simple refusal.',
                indicators: { timePressure: 'medium', interruptions: 'low', ambiguity: 'medium' }
            }
        };

        function getDefaultEvidence(construct) {
            return {
                scenario: `Adaptive scenario testing for ${construct.name}. Candidate was presented with domain-specific challenges calibrated to their demonstrated ability level.`,
                transcript: [
                    { speaker: 'system', content: 'Initial prompt presented based on role-relevant context.', time: '00:00' },
                    { speaker: 'candidate', content: 'Response captured and analyzed for construct-relevant indicators.', time: '00:30' },
                    { speaker: 'system', content: 'Follow-up probe adjusted based on initial response quality.', time: '01:00' }
                ],
                rationale: `Scoring based on standardized rubric for ${construct.id}. AI adapted difficulty and pacing while maintaining fixed scoring constructs.`,
                indicators: { timePressure: 'medium', interruptions: 'low', ambiguity: 'medium' }
            };
        }

        // ============================================================
        // STATE MANAGEMENT
        // ============================================================

        const state = {
            currentView: 'overview',
            selectedCandidate: null,
            selectedRole: 'ot-cyber',
            sortBy: 'aci',
            sortDirection: 'desc',
            roleFilter: 'all',
            cutlineFilter: false,
            candidates: generateCandidateData(),
            expandedSections: { cognitive: true, technical: false, integrity: false },
            expandedConstructs: {}
        };

        function setState(updates) {
            Object.assign(state, updates);
            render();
        }

        // ============================================================
        // RENDERING
        // ============================================================

        function render() {
            renderNavigation();
            renderCurrentView();
        }

        function renderNavigation() {
            document.querySelectorAll('.nav-tab').forEach(tab => {
                const view = tab.dataset.view;
                const isActive = view === state.currentView ||
                    (state.currentView === 'candidate-detail' && view === 'candidates');
                tab.classList.toggle('active', isActive);
                tab.setAttribute('aria-selected', isActive);
                tab.setAttribute('tabindex', isActive ? '0' : '-1');
            });
        }

        function renderCurrentView() {
            document.querySelectorAll('.view').forEach(view => {
                view.classList.remove('active');
            });

            const viewId = state.currentView === 'candidate-detail' ? 'candidate-detail' : state.currentView;
            const viewEl = document.getElementById(`view-${viewId}`);
            if (viewEl) {
                viewEl.classList.add('active');
            }

            switch (state.currentView) {
                case 'overview':
                    renderOverview();
                    break;
                case 'candidates':
                    renderCandidates();
                    break;
                case 'candidate-detail':
                    renderCandidateDetail();
                    break;
                case 'cutlines':
                    renderCutlines();
                    break;
                case 'heatmap':
                    renderHeatmap();
                    break;
            }
        }

        // ============================================================
        // OVERVIEW VIEW
        // ============================================================

        function renderOverview() {
            const container = document.getElementById('overview-dashboard');
            const candidates = getFilteredCandidates().slice(0, 6);

            let html = `<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1px; background: var(--border-primary); border: 1px solid var(--border-primary);">`;

            candidates.forEach(c => {
                const band = getBand(c.composites.aci);
                const roles = c.recommendedRoles.map(rid => ROLES.find(r => r.id === rid)?.abbr || rid);
                html += `
                    <div style="background: var(--bg-primary); padding: 32px; cursor: pointer; transition: background 0.2s;"
                         onmouseover="this.style.background='var(--bg-secondary)'"
                         onmouseout="this.style.background='var(--bg-primary)'"
                         data-candidate="${c.id}">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 16px;">
                            <div>
                                <div style="font-weight: 500; font-size: 15px; margin-bottom: 4px;">${c.name}</div>
                                <div style="font-size: 11px; color: var(--text-dim); font-family: var(--font-mono);">${c.id}</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-size: 32px; font-weight: 300; letter-spacing: -0.02em;">${c.composites.aci}</div>
                                <div style="font-size: 9px; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.1em;">${band.label}</div>
                            </div>
                        </div>
                        <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                            ${roles.map(r => `<span class="role-chip primary">${r}</span>`).join('')}
                        </div>
                    </div>
                `;
            });

            html += '</div>';
            container.innerHTML = html;

            container.querySelectorAll('[data-candidate]').forEach(el => {
                el.addEventListener('click', () => {
                    const candidateId = el.dataset.candidate;
                    setState({ currentView: 'candidate-detail', selectedCandidate: candidateId });
                });
            });
        }

        // ============================================================
        // CANDIDATES VIEW
        // ============================================================

        function getFilteredCandidates() {
            let candidates = [...state.candidates];

            if (state.roleFilter !== 'all') {
                candidates = candidates.filter(c => c.recommendedRoles.includes(state.roleFilter));
            }

            if (state.cutlineFilter && state.roleFilter !== 'all') {
                candidates = candidates.filter(c => meetsCutline(c, state.roleFilter));
            }

            const sortKey = {
                'aci': 'aci',
                'reliability': 'reliability',
                'learning': 'learningVelocity',
                'cyber': 'cyber',
                'manufacturing': 'manufacturingTechnical',
                'semiconductor': 'semiconductor',
                'integrity': 'integrity'
            }[state.sortBy] || 'aci';

            candidates.sort((a, b) => {
                const aVal = a.composites[sortKey];
                const bVal = b.composites[sortKey];
                return state.sortDirection === 'desc' ? bVal - aVal : aVal - bVal;
            });

            return candidates;
        }

        function meetsCutline(candidate, roleId) {
            const cutline = ROLE_CUTLINES[roleId];
            if (!cutline) return true;

            return cutline.requirements.every(req => {
                const score = req.construct ? candidate.scores[req.construct] : candidate.composites[req.composite];
                const percentile = scoreToPercentile(score);
                return percentile >= req.threshold;
            });
        }

        function renderCandidates() {
            const container = document.getElementById('candidates-table-container');
            const candidates = getFilteredCandidates();

            let html = `
                <table class="candidate-table" role="grid">
                    <thead>
                        <tr>
                            <th>Candidate</th>
                            <th>Status</th>
                            <th>Recommended Roles</th>
                            <th data-sort="aci" class="${state.sortBy === 'aci' ? 'sorted' : ''}">
                                ACI <span class="sort-indicator">${state.sortBy === 'aci' ? (state.sortDirection === 'desc' ? '↓' : '↑') : '↓'}</span>
                            </th>
                            <th data-sort="reliability" class="${state.sortBy === 'reliability' ? 'sorted' : ''}">
                                Reliability <span class="sort-indicator">${state.sortBy === 'reliability' ? (state.sortDirection === 'desc' ? '↓' : '↑') : '↓'}</span>
                            </th>
                            <th data-sort="learning" class="${state.sortBy === 'learning' ? 'sorted' : ''}">
                                Learning <span class="sort-indicator">${state.sortBy === 'learning' ? (state.sortDirection === 'desc' ? '↓' : '↑') : '↓'}</span>
                            </th>
                            <th data-sort="integrity" class="${state.sortBy === 'integrity' ? 'sorted' : ''}">
                                Integrity <span class="sort-indicator">${state.sortBy === 'integrity' ? (state.sortDirection === 'desc' ? '↓' : '↑') : '↓'}</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            candidates.forEach(c => {
                const aciBand = getBand(c.composites.aci);
                const reliabilityBand = getBand(c.composites.reliability);
                const learningBand = getBand(c.composites.learningVelocity);
                const integrityBand = getBand(c.composites.integrity);
                const roles = c.recommendedRoles.map(rid => ROLES.find(r => r.id === rid));

                html += `
                    <tr data-candidate="${c.id}" tabindex="0" role="row">
                        <td>
                            <div class="candidate-name">${c.name}</div>
                            <div class="candidate-id">${c.id}</div>
                        </td>
                        <td>
                            <span class="candidate-status ${c.status === 'complete' ? 'complete' : 'in-progress'}">
                                <span class="status-dot"></span>
                                ${c.status === 'complete' ? 'Complete' : 'In Progress'}
                            </span>
                        </td>
                        <td>
                            <div class="role-chips">
                                ${roles.map((r, i) => `<span class="role-chip ${i === 0 ? 'primary' : ''}">${r?.abbr || r?.name}</span>`).join('')}
                            </div>
                        </td>
                        <td><span class="score-cell ${aciBand.class}">${c.composites.aci}</span></td>
                        <td><span class="score-cell ${reliabilityBand.class}">${c.composites.reliability}</span></td>
                        <td><span class="score-cell ${learningBand.class}">${c.composites.learningVelocity}</span></td>
                        <td><span class="score-cell ${integrityBand.class}">${c.composites.integrity}</span></td>
                    </tr>
                `;
            });

            html += '</tbody></table>';
            container.innerHTML = html;

            container.querySelectorAll('th[data-sort]').forEach(th => {
                th.addEventListener('click', () => {
                    const sortKey = th.dataset.sort;
                    if (state.sortBy === sortKey) {
                        setState({ sortDirection: state.sortDirection === 'desc' ? 'asc' : 'desc' });
                    } else {
                        setState({ sortBy: sortKey, sortDirection: 'desc' });
                    }
                });
            });

            container.querySelectorAll('tr[data-candidate]').forEach(tr => {
                tr.addEventListener('click', () => {
                    setState({ currentView: 'candidate-detail', selectedCandidate: tr.dataset.candidate });
                });
                tr.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        setState({ currentView: 'candidate-detail', selectedCandidate: tr.dataset.candidate });
                    }
                });
            });
        }

        // ============================================================
        // CANDIDATE DETAIL VIEW
        // ============================================================

        function renderCandidateDetail() {
            const container = document.getElementById('candidate-detail-content');
            const candidate = state.candidates.find(c => c.id === state.selectedCandidate);

            if (!candidate) {
                container.innerHTML = '<p>Candidate not found.</p>';
                return;
            }

            const aciBand = getBand(candidate.composites.aci);

            let html = `
                <div class="detail-header">
                    <div class="detail-candidate-info">
                        <h2 class="detail-candidate-name">${candidate.name}</h2>
                        <div class="detail-candidate-meta">
                            <span style="font-family: var(--font-mono);">${candidate.id}</span>
                            <span class="divider"></span>
                            <span class="candidate-status ${candidate.status === 'complete' ? 'complete' : 'in-progress'}">
                                <span class="status-dot"></span>
                                ${candidate.status === 'complete' ? 'Complete' : 'In Progress'}
                            </span>
                            <span class="divider"></span>
                            <span class="onboarding-indicator">
                                <span class="onboarding-dot ${candidate.onboarding.toLowerCase().replace(' ', '-')}"></span>
                                ${candidate.onboarding}
                            </span>
                        </div>
                        <div class="detail-candidate-background">${candidate.background}</div>
                    </div>
                    <div class="detail-aci-score">
                        <div class="detail-aci-label">Arklight Cognitive Index</div>
                        <div class="detail-aci-value">${candidate.composites.aci}</div>
                        <div class="detail-aci-percentile">${ordinal(candidate.composites.aci)} Percentile</div>
                        <div class="detail-aci-band">${aciBand.label}</div>
                    </div>
                </div>

                <div class="composites-grid">
                    ${renderCompositeCard('General Technical', candidate.composites.generalTechnical)}
                    ${renderCompositeCard('Manufacturing', candidate.composites.manufacturingTechnical)}
                    ${renderCompositeCard('Semiconductor', candidate.composites.semiconductor)}
                    ${renderCompositeCard('Cyber Aptitude', candidate.composites.cyber)}
                    ${renderCompositeCard('Integrity', candidate.composites.integrity)}
                </div>

                <div class="charts-grid">
                    <div class="chart-container">
                        <h3 class="chart-title">Cognitive Profile</h3>
                        <div class="radar-chart" id="radar-chart"></div>
                    </div>
                    <div class="chart-container">
                        <h3 class="chart-title">Composite Indices</h3>
                        <div class="bar-chart">
                            ${renderBarItem('ACI Overall', candidate.composites.aci)}
                            ${renderBarItem('General Technical', candidate.composites.generalTechnical)}
                            ${renderBarItem('Manufacturing', candidate.composites.manufacturingTechnical)}
                            ${renderBarItem('Semiconductor', candidate.composites.semiconductor)}
                            ${renderBarItem('Cyber Aptitude', candidate.composites.cyber)}
                            ${renderBarItem('Integrity', candidate.composites.integrity)}
                            ${renderBarItem('Learning Velocity', candidate.composites.learningVelocity)}
                            ${renderBarItem('Reliability', candidate.composites.reliability)}
                        </div>
                    </div>
                </div>

                ${renderConstructSection('cognitive', 'Cognitive Core', CONSTRUCTS.cognitive, candidate)}
                ${renderConstructSection('technical', 'Technical Aptitude', CONSTRUCTS.technical, candidate)}
                ${renderConstructSection('integrity', 'Behavioral Integrity', CONSTRUCTS.integrity, candidate)}
            `;

            container.innerHTML = html;
            renderRadarChart(candidate);
            setupConstructListeners();
        }

        function renderCompositeCard(label, score) {
            const band = getBand(score);
            return `
                <div class="composite-card">
                    <div class="composite-label">${label}</div>
                    <div class="composite-value">${score}</div>
                    <div class="composite-percentile">${ordinal(score)} percentile</div>
                    <div class="composite-band">${band.label}</div>
                </div>
            `;
        }

        function renderBarItem(label, score) {
            const band = getBand(score);
            return `
                <div class="bar-item">
                    <div class="bar-label">${label}</div>
                    <div class="bar-track">
                        <div class="bar-fill ${band.class}" style="width: ${score}%;"></div>
                    </div>
                    <div class="bar-percentile">${score}</div>
                </div>
            `;
        }

        function renderConstructSection(sectionId, title, constructs, candidate) {
            const isExpanded = state.expandedSections[sectionId];
            return `
                <div class="construct-section ${isExpanded ? 'expanded' : ''}" data-section="${sectionId}">
                    <div class="construct-section-header" tabindex="0" role="button" aria-expanded="${isExpanded}">
                        <div class="construct-section-title">
                            ${title}
                            <span class="construct-section-count">${constructs.length} constructs</span>
                        </div>
                        <span class="construct-section-toggle">▼</span>
                    </div>
                    <div class="construct-cards">
                        ${constructs.map(c => renderConstructCard(c, candidate)).join('')}
                    </div>
                </div>
            `;
        }

        function renderConstructCard(construct, candidate) {
            const score = candidate.scores[construct.id];
            const percentile = scoreToPercentile(score);
            const band = getBand(percentile);
            const ci = getConfidenceInterval(score);
            const isExpanded = state.expandedConstructs[construct.id];
            const evidence = EVIDENCE_DATA[construct.id] || getDefaultEvidence(construct);

            return `
                <div class="construct-card ${isExpanded ? 'evidence-open' : ''}" data-construct="${construct.id}">
                    <div class="construct-card-header">
                        <div class="construct-info">
                            <div class="construct-name">
                                ${construct.name}
                                <span class="construct-abbr">${construct.id}</span>
                            </div>
                            <div class="construct-predicts">${construct.predicts}</div>
                            <div class="construct-matters">${construct.matters}</div>
                        </div>
                        <div class="construct-scores">
                            <div class="construct-score-secondary">
                                <div class="construct-percentile">${ordinal(percentile)} %ile</div>
                                <div class="construct-ci">${ci}</div>
                            </div>
                            <div class="construct-score-main">
                                <div class="construct-score-value text-${band.class}">${score}</div>
                                <div class="construct-score-label">${band.label}</div>
                            </div>
                            <button class="construct-expand-btn" aria-label="Show evidence">
                                ${isExpanded ? '−' : '+'}
                            </button>
                        </div>
                    </div>
                    <div class="construct-evidence">
                        <div class="evidence-section">
                            <div class="evidence-label">Scenario</div>
                            <div class="evidence-scenario">${evidence.scenario}</div>
                        </div>
                        <div class="evidence-section">
                            <div class="evidence-label">Transcript Excerpt</div>
                            <div class="evidence-transcript">
                                ${evidence.transcript.map(turn => `
                                    <div class="transcript-turn">
                                        <div class="transcript-speaker ${turn.speaker}">${turn.speaker === 'system' ? 'System' : 'Candidate'}</div>
                                        <div class="transcript-content">${turn.content}</div>
                                        <div class="transcript-timestamp">${turn.time}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        <div class="evidence-section">
                            <div class="evidence-label">Scoring Rationale</div>
                            <div class="evidence-rationale">${evidence.rationale}</div>
                        </div>
                        <div class="evidence-section">
                            <div class="evidence-label">Conditions</div>
                            <div class="evidence-indicators">
                                <div class="indicator-item">
                                    <span class="indicator-dot ${evidence.indicators.timePressure}"></span>
                                    Time Pressure: ${evidence.indicators.timePressure}
                                </div>
                                <div class="indicator-item">
                                    <span class="indicator-dot ${evidence.indicators.interruptions}"></span>
                                    Interruptions: ${evidence.indicators.interruptions}
                                </div>
                                <div class="indicator-item">
                                    <span class="indicator-dot ${evidence.indicators.ambiguity}"></span>
                                    Ambiguity: ${evidence.indicators.ambiguity}
                                </div>
                            </div>
                        </div>
                        <div class="evidence-section">
                            <div class="standardization-note">
                                AI adapts difficulty and pacing to candidate ability. Scoring constructs remain fixed across all candidates.
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function setupConstructListeners() {
            document.querySelectorAll('.construct-section-header').forEach(header => {
                header.addEventListener('click', () => {
                    const section = header.parentElement;
                    const sectionId = section.dataset.section;
                    state.expandedSections[sectionId] = !state.expandedSections[sectionId];
                    section.classList.toggle('expanded');
                    header.setAttribute('aria-expanded', state.expandedSections[sectionId]);
                });
                header.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        header.click();
                    }
                });
            });

            document.querySelectorAll('.construct-card-header').forEach(header => {
                header.addEventListener('click', () => {
                    const card = header.parentElement;
                    const constructId = card.dataset.construct;
                    state.expandedConstructs[constructId] = !state.expandedConstructs[constructId];
                    card.classList.toggle('evidence-open');
                    const btn = header.querySelector('.construct-expand-btn');
                    if (btn) btn.textContent = state.expandedConstructs[constructId] ? '−' : '+';
                });
            });
        }

        // ============================================================
        // RADAR CHART
        // ============================================================

        function renderRadarChart(candidate) {
            const container = document.getElementById('radar-chart');
            if (!container) return;

            const constructs = CONSTRUCTS.cognitive;
            const scores = constructs.map(c => candidate.scores[c.id]);
            const labels = constructs.map(c => c.id);

            const width = 320;
            const height = 320;
            const centerX = width / 2;
            const centerY = height / 2;
            const radius = 120;
            const levels = 4;

            let svg = `<svg viewBox="0 0 ${width} ${height}" width="${width}" height="${height}" role="img" aria-label="Radar chart">`;

            for (let level = 1; level <= levels; level++) {
                const levelRadius = (radius / levels) * level;
                const points = [];
                for (let i = 0; i < constructs.length; i++) {
                    const angle = (Math.PI * 2 * i) / constructs.length - Math.PI / 2;
                    const x = centerX + Math.cos(angle) * levelRadius;
                    const y = centerY + Math.sin(angle) * levelRadius;
                    points.push(`${x},${y}`);
                }
                svg += `<polygon points="${points.join(' ')}" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/>`;
            }

            for (let i = 0; i < constructs.length; i++) {
                const angle = (Math.PI * 2 * i) / constructs.length - Math.PI / 2;
                const x = centerX + Math.cos(angle) * radius;
                const y = centerY + Math.sin(angle) * radius;
                svg += `<line x1="${centerX}" y1="${centerY}" x2="${x}" y2="${y}" stroke="rgba(255,255,255,0.1)" stroke-width="1"/>`;

                const labelRadius = radius + 20;
                const labelX = centerX + Math.cos(angle) * labelRadius;
                const labelY = centerY + Math.sin(angle) * labelRadius;
                const textAnchor = Math.abs(Math.cos(angle)) < 0.1 ? 'middle' :
                                   Math.cos(angle) > 0 ? 'start' : 'end';
                svg += `<text x="${labelX}" y="${labelY}" text-anchor="${textAnchor}" fill="rgba(255,255,255,0.4)" font-size="10" font-family="var(--font-mono)" dominant-baseline="middle">${labels[i]}</text>`;
            }

            const dataPoints = [];
            for (let i = 0; i < constructs.length; i++) {
                const angle = (Math.PI * 2 * i) / constructs.length - Math.PI / 2;
                const value = scores[i] / 100;
                const x = centerX + Math.cos(angle) * radius * value;
                const y = centerY + Math.sin(angle) * radius * value;
                dataPoints.push(`${x},${y}`);
            }

            svg += `<polygon points="${dataPoints.join(' ')}" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.6)" stroke-width="1"/>`;

            for (let i = 0; i < constructs.length; i++) {
                const angle = (Math.PI * 2 * i) / constructs.length - Math.PI / 2;
                const value = scores[i] / 100;
                const x = centerX + Math.cos(angle) * radius * value;
                const y = centerY + Math.sin(angle) * radius * value;
                svg += `<circle cx="${x}" cy="${y}" r="3" fill="white"/>`;
            }

            svg += '</svg>';
            container.innerHTML = svg;
        }

        // ============================================================
        // CUTLINES VIEW
        // ============================================================

        function renderCutlines() {
            const container = document.getElementById('cutlines-content');

            let html = `
                <div class="cutlines-container">
                    <div class="cutlines-roles">
                        ${ROLES.map(role => {
                            const meetCount = state.candidates.filter(c => meetsCutline(c, role.id)).length;
                            return `
                                <div class="cutlines-role-item ${state.selectedRole === role.id ? 'selected' : ''}" data-role="${role.id}" tabindex="0">
                                    <div class="cutlines-role-name">${role.name}</div>
                                    <div class="cutlines-role-count">${meetCount} of ${state.candidates.length} qualify</div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    <div class="cutlines-detail">
                        ${renderCutlineDetail()}
                    </div>
                </div>
            `;

            container.innerHTML = html;

            container.querySelectorAll('.cutlines-role-item').forEach(item => {
                item.addEventListener('click', () => {
                    state.selectedRole = item.dataset.role;
                    renderCutlines();
                });
                item.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        state.selectedRole = item.dataset.role;
                        renderCutlines();
                    }
                });
            });

            container.querySelectorAll('.cutline-candidate-row').forEach(row => {
                row.addEventListener('click', () => {
                    setState({ currentView: 'candidate-detail', selectedCandidate: row.dataset.candidate });
                });
            });
        }

        function renderCutlineDetail() {
            const cutline = ROLE_CUTLINES[state.selectedRole];
            const role = ROLES.find(r => r.id === state.selectedRole);

            if (!cutline || !role) return '<p>Select a role to view cutlines.</p>';

            let html = `
                <h3>${role.name}</h3>
                <div class="cutlines-requirements">
                    <div class="evidence-label" style="margin-top: 24px;">Requirements</div>
                    ${cutline.requirements.map(req => {
                        const label = req.construct ?
                            (CONSTRUCTS.cognitive.find(c => c.id === req.construct) ||
                             CONSTRUCTS.technical.find(c => c.id === req.construct) ||
                             CONSTRUCTS.integrity.find(c => c.id === req.construct))?.name || req.construct :
                            req.composite.replace(/([A-Z])/g, ' $1').trim();
                        return `
                            <div class="requirement-item">
                                <span class="requirement-construct">${label}</span>
                                <span class="requirement-threshold">≥ ${ordinal(req.threshold)}</span>
                            </div>
                        `;
                    }).join('')}
                </div>
                <div class="cutlines-candidates">
                    <div class="evidence-label">Candidates</div>
                    ${state.candidates.map(c => {
                        const passes = meetsCutline(c, state.selectedRole);
                        return `
                            <div class="cutline-candidate-row" data-candidate="${c.id}">
                                <div class="cutline-candidate-info">
                                    <div class="cutline-status-icon ${passes ? 'pass' : 'fail'}">
                                        ${passes ? '✓' : '—'}
                                    </div>
                                    <div class="cutline-candidate-name">${c.name}</div>
                                </div>
                                <div class="cutline-score">${c.composites.aci}</div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;

            const firstMatch = state.candidates.find(c => meetsCutline(c, state.selectedRole));
            if (firstMatch) {
                html += renderFitExplanation(firstMatch, state.selectedRole);
            }

            return html;
        }

        function renderFitExplanation(candidate, roleId) {
            const drivers = [];
            const risks = [];
            const allConstructs = [...CONSTRUCTS.cognitive, ...CONSTRUCTS.technical, ...CONSTRUCTS.integrity];

            const constructScores = allConstructs.map(c => ({
                construct: c,
                score: candidate.scores[c.id],
                percentile: scoreToPercentile(candidate.scores[c.id])
            }));

            constructScores.sort((a, b) => b.percentile - a.percentile);

            constructScores.slice(0, 3).forEach(cs => {
                drivers.push(`${cs.construct.name} (${ordinal(cs.percentile)}) — ${cs.construct.predicts.toLowerCase()}`);
            });

            constructScores.slice(-3).forEach(cs => {
                if (cs.percentile < 60) {
                    risks.push(`${cs.construct.name} (${ordinal(cs.percentile)}) may require support`);
                }
            });

            if (risks.length === 0) {
                risks.push('No significant risks identified');
            }

            return `
                <div class="fit-explanation">
                    <div class="fit-title">Fit Analysis: ${candidate.name}</div>
                    <div class="fit-section">
                        <div class="fit-section-label">Strengths</div>
                        ${drivers.map(d => `
                            <div class="fit-item driver">
                                <span class="icon">↑</span>
                                <span>${d}</span>
                            </div>
                        `).join('')}
                    </div>
                    <div class="fit-section">
                        <div class="fit-section-label">Considerations</div>
                        ${risks.map(r => `
                            <div class="fit-item risk">
                                <span class="icon">→</span>
                                <span>${r}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // ============================================================
        // HEATMAP VIEW
        // ============================================================

        function renderHeatmap() {
            const container = document.getElementById('heatmap-content');
            const candidates = getFilteredCandidates();
            const allConstructs = [...CONSTRUCTS.cognitive, ...CONSTRUCTS.technical, ...CONSTRUCTS.integrity];

            function getHeatColor(percentile) {
                if (percentile >= 85) return 'background: rgba(255,255,255,0.2); color: #fff;';
                if (percentile >= 70) return 'background: rgba(255,255,255,0.12); color: rgba(255,255,255,0.9);';
                if (percentile >= 55) return 'background: rgba(255,255,255,0.06); color: rgba(255,255,255,0.7);';
                if (percentile >= 40) return 'background: rgba(255,255,255,0.02); color: rgba(255,255,255,0.5);';
                return 'background: transparent; color: rgba(255,255,255,0.3);';
            }

            let html = `
                <div class="chart-container" style="margin-bottom: 40px;">
                    <h3 class="chart-title">Construct Scores</h3>
                    <div class="heatmap-container">
                        <table class="heatmap-table">
                            <thead>
                                <tr>
                                    <th style="text-align: left; padding-left: 16px;">Candidate</th>
                                    ${allConstructs.map(c => `<th class="rotate">${c.id}</th>`).join('')}
                                </tr>
                            </thead>
                            <tbody>
                                ${candidates.map(cand => `
                                    <tr>
                                        <td class="candidate-col">${cand.name}</td>
                                        ${allConstructs.map(c => {
                                            const score = cand.scores[c.id];
                                            const percentile = scoreToPercentile(score);
                                            return `<td class="heatmap-cell" style="${getHeatColor(percentile)}">${score}</td>`;
                                        }).join('')}
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="chart-container">
                    <h3 class="chart-title">Role Qualification</h3>
                    <div class="heatmap-container">
                        <table class="heatmap-table">
                            <thead>
                                <tr>
                                    <th style="text-align: left; padding-left: 16px;">Candidate</th>
                                    ${ROLES.map(r => `<th class="rotate">${r.abbr}</th>`).join('')}
                                </tr>
                            </thead>
                            <tbody>
                                ${candidates.map(cand => `
                                    <tr>
                                        <td class="candidate-col">${cand.name}</td>
                                        ${ROLES.map(role => {
                                            const passes = meetsCutline(cand, role.id);
                                            const style = passes ?
                                                'background: rgba(255,255,255,0.1); color: var(--text-primary);' :
                                                'color: rgba(255,255,255,0.2);';
                                            return `<td class="heatmap-cell" style="${style}">${passes ? '✓' : '—'}</td>`;
                                        }).join('')}
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;

            container.innerHTML = html;
        }

        // ============================================================
        // EVENT HANDLERS
        // ============================================================

        function initEventListeners() {
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const view = tab.dataset.view;
                    setState({ currentView: view, selectedCandidate: null });
                });
                tab.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        tab.click();
                    }
                });
            });

            document.getElementById('back-to-candidates').addEventListener('click', () => {
                setState({ currentView: 'candidates', selectedCandidate: null });
            });

            document.getElementById('sort-select').addEventListener('change', (e) => {
                setState({ sortBy: e.target.value });
            });

            document.getElementById('role-filter').addEventListener('change', (e) => {
                setState({ roleFilter: e.target.value });
            });

            document.getElementById('cutline-filter').addEventListener('change', (e) => {
                setState({ cutlineFilter: e.target.checked });
            });

            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && state.currentView === 'candidate-detail') {
                    setState({ currentView: 'candidates', selectedCandidate: null });
                }
            });
        }

        // ============================================================
        // INITIALIZATION
        // ============================================================

        function init() {
            initEventListeners();
            render();
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }

    })();
    </script>
</body>
</html>
